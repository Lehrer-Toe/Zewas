[build]
  # Build-Einstellungen für statische Website
  publish = "."
  command = "echo 'Statische Website - kein Build erforderlich'"

[build.environment]
  # Node.js Version für eventuelle Build-Prozesse
  NODE_VERSION = "18"

# Redirects und Rewrites
[[redirects]]
  # SPA (Single Page Application) Support
  from = "/*"
  to = "/index.html"
  status = 200
  conditions = {Role = ["admin", "lehrer"]}

[[redirects]]
  # Admin-Bereich Schutz
  from = "/admin/*"
  to = "/index.html"
  status = 200
  conditions = {Role = ["admin"]}

# Security Headers
[[headers]]
  for = "/*"
  [headers.values]
    # Content Security Policy
    Content-Security-Policy = '''
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://*.firebaseapp.com https://*.googleapis.com;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
      font-src 'self' https://fonts.gstatic.com;
      img-src 'self' data: blob: https://*.firebaseapp.com https://*.googleapis.com;
      connect-src 'self' https://*.firebaseapp.com https://*.googleapis.com https://*.firebaseio.com wss://*.firebaseio.com;
      frame-src 'self' https://*.firebaseapp.com;
    '''
    
    # Weitere Security Headers
    X-Frame-Options = "SAMEORIGIN"
    X-Content-Type-Options = "nosniff"
    X-XSS-Protection = "1; mode=block"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "camera=(), microphone=(), geolocation=()"

# Asset-Optimierung
[[headers]]
  for = "*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Entwicklungsumgebung
[context.deploy-preview]
  [context.deploy-preview.environment]
    FIREBASE_PROJECT_ID = "zeig-was-du-kannst-dev"
    NODE_ENV = "development"

[context.branch-deploy]
  [context.branch-deploy.environment]
    NODE_ENV = "development"

# Produktionsumgebung
[context.production]
  [context.production.environment]
    NODE_ENV = "production"

# Funktionen (falls später benötigt)
[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# Plugin-Konfiguration
[[plugins]]
  package = "@netlify/plugin-lighthouse"
  
  [plugins.inputs.audits]
    performance = true
    accessibility = true
    best-practices = true
    seo = true

# Edge Functions (optional für Zukunft)
[[edge_functions]]
  function = "auth-check"
  path = "/admin/*"

# Environment-spezifische Einstellungen
[template.environment]
  FIREBASE_API_KEY = "Dein Firebase API Key"
  FIREBASE_AUTH_DOMAIN = "dein-projekt.firebaseapp.com"
  FIREBASE_PROJECT_ID = "dein-projekt-id"
  FIREBASE_STORAGE_BUCKET = "dein-projekt.appspot.com"
  FIREBASE_MESSAGING_SENDER_ID = "deine-sender-id"
  FIREBASE_APP_ID = "deine-app-id"
  FIREBASE_DATABASE_URL = "https://dein-projekt-default-rtdb.europe-west1.firebasedatabase.app/"
